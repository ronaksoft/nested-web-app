<div class="create-task">
  <div class="task-title auto-height-item">
    <div class="task-input-wrapper ng-class:{'focus' : taskTitle, 'error' : ctrl.taskTitle.length > 64}">
      <textarea type="text" class="no-style gale-holder create-task-input" placeholder="Enter a Task Title" id="task-title" ng-focus="taskTitle = true"
        ng-blur="taskTitle = false" resize-textarea ng-model="ctrl.taskTitle" enter-key="ctrl.enterSubjectTask()" prevent-shift-enter="true"></textarea>
      <div class="error-handler" ng-if="ctrl.taskTitle.length > 54">
        {{ctrl.taskTitle.length | localize}} / 64
      </div>
    </div>
    <label for="task-title">
      <svg class="_32svg">
        <use xlink:href="/assets/icons/nst-task-icn32.svg#in-progress-simple"></use>
      </svg>
    </label>
  </div>
  <div class="task-assignee auto-height-item">
    <div class="task-input-wrapper ng-class:{'focus' : ctrl.assigneeFocus}">
      <task-assignee assignees-data="ctrl.assigneesData" assignee-focus="ctrl.assigneeFocus" assignee-with-candidate="true" assignee-placeholder="{{ctrl.assigneePlaceholder}}"></task-assignee>
      <div ng-if="ctrl.assigneeFocus != true && ctrl.assigneesData.length == 1" ng-click="ctrl.assigneeFocus = true;" class="unfocused-input"
        translate-inner>Assigned to <b>{{ctrl.assigneesData[0].fullName}}</b></div>
      <div ng-if="ctrl.assigneeFocus != true && ctrl.assigneesData.length > 1" ng-click="ctrl.assigneeFocus = true;" class="unfocused-input candidates">
        <translate>Candidates:</translate>
        <span ng-repeat="assigneeData in ctrl.assigneesData">
            <b>{{assigneeData.fullName}}</b>{{ctrl.assigneesData.length - 2 == $index? ' & ': (ctrl.assigneesData.length - 2 > $index? ', ': '')}}
          </span>
      </div>
    </div>
    <label ng-class="{'focus' : ctrl.assigneeFocus}">
      <svg class="_24svg" ng-if="ctrl.assigneeIcon == 'no-assignee'">
        <use xlink:href="/assets/icons/nst-icn24.svg#ask-wire"></use>
      </svg>
      <img initial-avatar="{{ctrl.assigneeIcon}}" name="{{ctrl.assigneeIcon}}"
           picture="{{ctrl.assigneeIcon | avatar : 'x32'}}" data-width="24" data-height="24"
           data-radius="40" class="account-initials-24 _df" data-word-count="2" data-font-size="13"
           ng-if="ctrl.assigneeIcon != 'no-assignee' && ctrl.assigneeIcon != 'candidate'"/>
      <svg class="_24svg" ng-if="ctrl.assigneeIcon == 'candidate'">
        <use xlink:href="/assets/icons/nst-task-icn32.svg#candidate"></use>
      </svg>
    </label>
  </div>
  <div class="task-due const-height-item">
    <div class="task-input-wrapper ng-class:{'focus' : taskDue}">
      <input type="text" class="no-style gale-holder create-task-input" translate-attrs="placeholder" placeholder="+ Set a due time (optional)"
        id="task-due" ng-focus="taskDue = true" ng-blur="taskDue = false" ng-model="ctrl.dueDate" data-config="ctrl.datePickerconfig"
        g-formatted-picked-date="gfdate" g-picked-date="gdate" ng-jalaali-flat-datepicker>
    </div>
    <label for="task-due" ng-class="{'focus' : taskDue}">
      <div class="_24svg _df _jcc _aic" data-uib-tooltip="Remove Due Time" data-tooltip-placement="top-center auto"
            data-tooltip-append-to-body="true">
            <svg class="_16svg static-item">
                <use xlink:href="/assets/icons/nst-icn16.svg#finish-flag"></use>
            </svg>
            <svg class="_16svg force hover-item" ng-if="true">
                <use xlink:href="/assets/icons/nst-icn16.svg#bin"></use>
            </svg>
            <svg class="_16svg force hover-item" ng-if="false">
                <use xlink:href="/assets/icons/nst-icn16.svg#negative-xcross"></use>
            </svg>
        </div>
    </label>
  </div>
  <div class="task-more-options ng-class:{'visible' : ctrl.showMoreOption}">
    <div class="task-description auto-height-item ng-class:{'focus' : taskDes}">
      <div class="task-input-wrapper">
        <textarea class="no-style gale-holder create-task-input" ng-focus="taskDes = true" ng-blur="taskDes = false" enter-key="ctrl.enterDescriptionTask()"
          placeholder="+ Add a Description â€¦" id="task-description" resize-textarea></textarea>
      </div>
      <label for="task-description" ng-class="{'focus' : taskDes}">
        <svg class="_16svg">
          <use xlink:href="/assets/icons/nst-icn16.svg#petition"></use>
        </svg>
      </label>
    </div>
    <div class="task-todo auto-height-item">
      <div class="_difv _fw">
        <h3>
          <translate>To-Do list</translate>
        </h3>
        <ul class="todo-list ng-class:{'focus' : tasktodo}">
          <!--<li ng-init="isChecked = true">
            <input class="_fr" type="checkbox" id="todo1" ng-model="isChecked"/>
            <label class="_fw todo task-input-wrapper" for="todo1">
              <svg class="_16svg _df" ng-if="!isChecked">
                <use xlink:href="/assets/icons/nst-icn16.svg#todo-undone"></use>
              </svg>
              <svg class="_16svg _df" ng-if="isChecked">
                <use xlink:href="/assets/icons/nst-icn16.svg#todo-done"></use>
              </svg>
              <textarea class="no-style gale-holder create-task-input f1"
                        ng-focus="tasktodo = true" ng-blur="tasktodo = false" focus-me="{{ctrl.assigneTodoTrigger}}"
                        placeholder="+ add a to-do" resize-textarea></textarea>
            </label>
          </li>
          <li ng-init="isCheckeds = false">
            <input class="_fr" type="checkbox" id="todo2" ng-model="isCheckeds"/>
            <label class="_fw todo task-input-wrapper" for="todo2">
              <svg class="_16svg _df" ng-if="!isCheckeds">
                <use xlink:href="/assets/icons/nst-icn16.svg#todo-undone"></use>
              </svg>
              <svg class="_16svg _df" ng-if="isCheckeds">
                <use xlink:href="/assets/icons/nst-icn16.svg#todo-done"></use>
              </svg>
              <textarea class="no-style gale-holder create-task-input f1"
                        ng-focus="tasktodos = true" ng-blur="tasktodos = false"
                        placeholder="+ add a to-do" resize-textarea></textarea>
            </label>-->
          <task-todo-item todo-focus="ctrl.todoFocus"></task-todo-item>
          </li>
        </ul>
      </div>
      <label ng-class="{'focus' : tasktodo}"> 
        <div class="_24svg _df _jcc _aic" data-uib-tooltip="Remove To-Do list" data-tooltip-placement="top-center auto"
            data-tooltip-append-to-body="true">
            <svg class="_16svg static-item">
                <use xlink:href="/assets/icons/nst-icn16.svg#bullet-list"></use>
            </svg>
            <svg class="_16svg force hover-item" ng-if="true">
                <use xlink:href="/assets/icons/nst-icn16.svg#bin"></use>
            </svg>
            <svg class="_16svg force hover-item" ng-if="false">
                <use xlink:href="/assets/icons/nst-icn16.svg#negative-xcross"></use>
            </svg>
        </div>
      </label>
    </div>
    <div class="task-attachment auto-height-item">
      <div class="_difv _fw">
        <h3>Attachments</h3>
        <div class="attachments-badge-wrapper">
          <nst-attachments-editable-bar mode="badge" items="ctrl.attachments.viewModels" on-item-delete="ctrl.detach"></nst-attachments-editable-bar>
          <a class="attachment-plus ng-class:{'active' : openPopover}" ng-init="openPopover = false" ng-click="openPopover =! openPopover"
            data-popover-class="files-menu-popover" move-add-attachment-element data-popover-append-to-body="true" uib-popover-template="'app/task/common/popovers/add-attachment-popover.html'"
            data-popover-trigger="focus" data-popover-placement="auto {{$root._direction === 'rtl' ? 'left' : 'right'}}" data-popover-is-open="openPopover">
            <svg class="_16svg ng-class:{'_r45' : openPopover}">
              <use xlink:href="/assets/icons/nst-icn16.svg#cross"></use>
            </svg>
          </a>
        </div>
        <!-- Make unique id -->
        <input id="upload-files" type="file" multiple on-file-change="ctrl.attachments.fileSelected" />
        <input id="upload-media" type="file" multiple on-file-change="ctrl.attachments.mediaSelected" />
      </div>
      <label>
        <div class="_24svg _df _jcc _aic" data-uib-tooltip="Remove All Attachments" data-tooltip-placement="top-center auto"
            data-tooltip-append-to-body="true">
            <svg class="_16svg static-item">
                <use xlink:href="/assets/icons/nst-icn16.svg#attach"></use>
            </svg>
            <svg class="_16svg force hover-item" ng-if="true">
                <use xlink:href="/assets/icons/nst-icn16.svg#bin"></use>
            </svg>
            <svg class="_16svg force hover-item" ng-if="false">
                <use xlink:href="/assets/icons/nst-icn16.svg#negative-xcross"></use>
            </svg>
        </div>
      </label>
    </div>
    <div class="task-watchers auto-height-item">
      <div class="_difv _fw">
        <h3>
          <translate>Watchers</translate>
        </h3>
        <div class="task-input-wrapper ng-class:{'focus' : ctrl.watcherFocus}">
          <task-assignee assignees-data="ctrl.watchersData" assignee-focus="ctrl.watcherFocus" assignee-with-candidate="false" assignee-placeholder="{{ctrl.watcherPlaceholder}}"></task-assignee>
        </div>
      </div>
      <label ng-class="{'focus' : ctrl.watcherFocus}">
        <div class="_24svg _df _jcc _aic" data-uib-tooltip="Remove All Attachments" data-tooltip-placement="top-center auto"
            data-tooltip-append-to-body="true">
            <svg class="_16svg static-item">
                <use xlink:href="/assets/icons/nst-icn16.svg#person"></use>
            </svg>
            <svg class="_16svg force hover-item" ng-if="true">
                <use xlink:href="/assets/icons/nst-icn16.svg#bin"></use>
            </svg>
            <svg class="_16svg force hover-item" ng-if="false">
                <use xlink:href="/assets/icons/nst-icn16.svg#negative-xcross"></use>
            </svg>
        </div>
      </label>
    </div>
    <div class="task-labels auto-height-item">
      <div class="_difv _fw">
        <h3>
          <translate>Labels</translate>
        </h3>
        <div class="task-input-wrapper ng-class:{'focus' : labelFocus}">
          <task-label labels-data="ctrl.labelsData" label-focus="ctrl.labelsFocus" label-placeholder="{{ctrl.labelPlaceholder}}"></task-label>
        </div>
      </div>
      <label ng-class="{'focus' : labelFocus}">
        <div class="_24svg _df _jcc _aic" data-uib-tooltip="Remove All Watchers" data-tooltip-placement="top-center auto"
            data-tooltip-append-to-body="true">
            <svg class="_16svg static-item">
                <use xlink:href="/assets/icons/nst-icn16.svg#tag"></use>
            </svg>
            <svg class="_16svg force hover-item" ng-if="true">
                <use xlink:href="/assets/icons/nst-icn16.svg#bin"></use>
            </svg>
            <svg class="_16svg force hover-item" ng-if="false">
                <use xlink:href="/assets/icons/nst-icn16.svg#negative-xcross"></use>
            </svg>
        </div>
        </label>
    </div>
  </div>
  <div class="task-footer const-height-item">
    <input type="button" class="butn butn-green" disabled value="Create Task">
    <a class="_df _fw" ng-if="!ctrl.showMoreOption" ng-click="ctrl.showMoreOption =! ctrl.showMoreOption">
      <translate>More options</translate>
    </a>
    <a class="_df _fw" ng-if="ctrl.showMoreOption" ng-click="ctrl.showMoreOption =! ctrl.showMoreOption">
      <translate>Hide options</translate>
    </a>
  </div>
</div>
